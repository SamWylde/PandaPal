{
    "version": 2,
    "env": {
        "NODE_OPTIONS": "--no-deprecation"
    },
    "functions": {
        "api/**/*.js": {
            "includeFiles": "node_modules/puppeteer-extra-plugin-*/**,scraper/node_modules/puppeteer-extra-plugin-*/**",
            "maxDuration": 300
        }
    },
    "crons": [
        {
            "path": "/api/crawl",
            "schedule": "0 3 * * *"
        },
        {
            "path": "/api/cron/prowlarr-update",
            "schedule": "30 * * * *"
        },
        {
            "path": "/api/cron/health-check",
            "schedule": "0 * * * *"
        }
    ],
    "rewrites": [
        {
            "source": "/",
            "destination": "/api/configure.js"
        },
        {
            "source": "/configure",
            "destination": "/api/configure.js"
        },
        {
            "source": "/c/:configs/configure",
            "destination": "/api/configure.js?configs=:configs"
        },
        {
            "source": "/api/crawl",
            "destination": "/api/crawl.py"
        },
        {
            "source": "/catalog/manifest\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/c/:configs/catalog/manifest\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/(manifest\\.json)",
            "destination": "/api/manifest.js"
        },
        {
            "source": "/c/:configs/manifest\\.json",
            "destination": "/api/manifest.js?configs=:configs"
        },
        {
            "source": "/catalog/:type/:id\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/catalog/:type/:id/:extras\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/c/:configs/catalog/:type/:id\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/c/:configs/catalog/:type/:id/:extras\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/meta/:type/:id\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/c/:configs/meta/:type/:id\\.json",
            "destination": "/api/catalog.py"
        },
        {
            "source": "/stream/:type/:id\\.json",
            "destination": "/api/scraper.js"
        },
        {
            "source": "/stream/:type/:id/:extra\\.json",
            "destination": "/api/scraper.js"
        },
        {
            "source": "/c/:configs/stream/:type/:id\\.json",
            "destination": "/api/scraper.js"
        },
        {
            "source": "/c/:configs/stream/:type/:id/:extra\\.json",
            "destination": "/api/scraper.js"
        },
        {
            "source": "/cyberflix-ui",
            "destination": "/catalog/web/index.html"
        },
        {
            "source": "/static/css/(.*)",
            "destination": "/scraper/static/css/$1"
        },
        {
            "source": "/static/js/(.*)",
            "destination": "/scraper/static/js/$1"
        },
        {
            "source": "/static/(.*)",
            "destination": "/catalog/web/$1"
        },
        {
            "source": "/assets/(.*)",
            "destination": "/catalog/web/assets/$1"
        }
    ]
}